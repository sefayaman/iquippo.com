<div id="wrapper">
  <div id="page-wrapper">
    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-6">
          <h3>Reports</h3>
        </div>
        <div class="col-sm-6 text-right">
            <h3><button class="btn btn-success btn-md" ng-click="reportsVm.exportExcel()"><i class="fa fa-file-excel-o"></i> Export</button></h3>
        </div>     
      </div>
      <hr>
      <p class="text-right">Showing : {{reportsVm.totalItems}} Records</p>
     
        <div class="row"> 
          <div class="col-sm-9">
            <div class="">
              <select ng-model="reportsVm.tabValue" ng-change="reportsVm.selectReportData(reportsVm.tabValue)">
                <option value="callback">Call Back</option>
                <option value="quickQuery">Quick Query</option>
                <option value="additionalServices">Get a Quote for Additional Services</option>
                <option value="buyOrRentOrBoth">Send Message - To Buy / For Rent / For Both</option>
                <option value="shipping">Shipping</option>
                <option value="valuation">Valuation</option>
                <option value="finance">Financing</option>
                <option value="insurance">Insurance</option>
              </select>
            </div>
          </div>                  
          <div class="col-sm-3 pull-right">
            <div class="tablesearch text-right form-group">
               Search: <input type="text" placeholder="Search..." ng-model="reportsVm.searchStr" ng-change="reportsVm.fireCommand(true)" ng-model-options="{debounce:500}">
            </div>
          </div>
        </div>
        <div ng-if="reportsVm.tabValue == 'callback'">
          <div class="table-responsive">
            <table class="table table-bordred table-striped">
              <thead>
               <tr>
                  <th>Sr. No</th> 
                  <th>Full Name</th>                                
                  <th>Mobile No.</th>                                
                  <th>Phone No.</th>                                
                  <th>Email Address</th>                                
                  <th>Date of Request</th>  
               </tr>
              </thead>
              <tbody>
              <tr ng-repeat="callback in reportsVm.callbackListing">
                <td>{{$index + 1 + count}}</td>
                <td>{{callback.fname}} {{callback.lname}}</td>              
                <td>{{callback.mobile}}</td>
                <td>{{callback.phone}}</td>
                <td>{{callback.email}}</td>
                <td>{{callback.createdAt | date:'MM/dd/yyyy'}}</td>                    
               </tr>
              </tbody>
            </table>
          </div>
          <uib-pagination total-items="reportsVm.totalItems" ng-model="reportsVm.currentPage" items-per-page="reportsVm.itemsPerPage" max-size="reportsVm.maxSize" ng-change="reportsVm.fireCommand()" class="pagination-sm" rotate="false">  </uib-pagination>
        </div>
        <div ng-if="reportsVm.tabValue == 'quickQuery'">
          <div class="table-responsive" >
            <table class="table table-bordred table-striped">
              <thead>
                <tr>
                  <th>Sr. No</th> 
                  <th>Full Name</th>                                
                  <th>Mobile No.</th>                                
                  <th>Phone No.</th>                                
                  <th>Email Address</th>                                
                  <th>Date of Request</th>  
                  <th>Category</th>  
                  <th>Brand</th>  
                  <th>Model No.</th>  
                  <th>Expected Price</th>  
                  <th>Location</th>  
                  <th>Comments</th> 
                </tr> 
              </thead>
              <tbody>
              <tr  ng-repeat="query in reportsVm.quickQueryListing">
                <td>{{$index + 1 + count}}</td>
                <td>{{query.fname}} {{query.lname}}</td>              
                <td>{{query.mobile}}</td>
                <td>{{query.phone}}</td>
                <td>{{query.email}}</td>
                <td>{{query.createdAt | date:'MM/dd/yyyy'}}</td>                     
                <td>{{query.category}}</td>                    
                <td>{{query.brand}}</td>                    
                <td>{{query.model}}</td>                    
                <td>{{query.expPrice}}</td>                    
                <td>{{query.city}}</td>                    
                <td>{{query.comment}}</td>                    
               </tr>
              </tbody>
            </table>
          </div>
            <uib-pagination total-items="reportsVm.totalItems" ng-model="reportsVm.currentPage" items-per-page="reportsVm.itemsPerPage" max-size="reportsVm.maxSize" ng-change="reportsVm.fireCommand()" class="pagination-sm" rotate="false">  </uib-pagination>
          </div>

          <div ng-if="reportsVm.tabValue == 'additionalServices'">
          <div class="table-responsive" >
            <table class="table table-bordred table-striped">
              <thead>
                <tr>
                  <th>Sr. No</th> 
                  <th>Full Name</th>                                
                  <th>Mobile No.</th>                                
                  <th>Phone No.</th>                                
                  <th>Email Address</th>                                
                  <th>Date of Request</th>  
                  <th>Country</th>  
                  <th>Location</th>  
                  <th>Company Name</th>  
                  <th>Designation</th>  
                  <th>Part Shipment Allowed</th>  
                  <th>Packaging</th>  
                  <th>Shipping <small>Comments</small></th>  
                  <th>Valuation <small>Purpose of Valutaion</small></th>
                  <th>Valuation <small>Schedule a Call</small></th>  
                  <th>Valuation <small>Comments</small></th>  
                  <th>Certified <small>Purpose of Valutaion</small></th>  
                  <th>Certified <small>Schedule a Call</small></th>  
                  <th>Certified <small>Comments</small></th>  
                  <th>Manpower <small>Operators</small></th>  
                  <th>Manpower <small>Equipments</small></th>  
                  <th>Manpower <small>Schedule a Call</small></th>  
                  <th>Manpower <small>Comments</small></th>
                </tr>  
              </thead>
              <tbody>
              <tr  ng-repeat="addSvc in reportsVm.additionalSvcListing">
                <td>{{$index + 1+count}}</td>
                <td>{{addSvc.fname}} {{addSvc.lname}}</td>              
                <td>{{addSvc.mobile}}</td>
                <td>{{addSvc.phone}}</td>
                <td>{{addSvc.email}}</td>
                <td>{{addSvc.createdAt | date:'MM/dd/yyyy'}}</td>
                <td>{{addSvc.country}}</td>                    
                <td>{{addSvc.city}}</td>                    
                <td>{{addSvc.companyname}}</td>                    
                <td>{{addSvc.designation}}</td>                    
                <td>{{addSvc.shippingQuote.allowed}}</td>                    
                <td>{{addSvc.shippingQuote.packaging}}</td> 
                <td>{{addSvc.shippingQuote.comments}}</td>                   
                <td>
                  <span ng-if="addSvc.valuationQuote.valuation != 'Other'">{{addSvc.valuationQuote.valuation}}</span>
                  <span ng-if="addSvc.valuationQuote.valuation == 'Other'">{{addSvc.valuationQuote.otherName}}</span>
                </td>                    
                <td>{{addSvc.valuationQuote.schedule}}</td>                    
                <td>{{addSvc.valuationQuote.comment}}</td>                    
                <td>
                  <span ng-if="addSvc.certifiedByIQuippoQuote.valuation != 'Other'">{{addSvc.certifiedByIQuippoQuote.valuation}}</span>
                  <span ng-if="addSvc.certifiedByIQuippoQuote.valuation == 'Other'">{{addSvc.certifiedByIQuippoQuote.otherName}}</span>
                </td>                    
                <td>{{addSvc.certifiedByIQuippoQuote.scheduleC}}</td>                    
                <td>{{addSvc.certifiedByIQuippoQuote.comment}}</td>                    
                <td>
                  <span ng-if="addSvc.manpowerQuote.usedBy != 'Other'">{{addSvc.manpowerQuote.usedBy}}</span>
                  <span ng-if="addSvc.manpowerQuote.usedBy == 'Other'">{{addSvc.manpowerQuote.otherName}}</span>
                </td>        
                <td>{{addSvc.manpowerQuote.equipments}}</td>                    
                <td>{{addSvc.manpowerQuote.scheduleM}}</td>                    
                <td>{{addSvc.manpowerQuote.comment}}</td>                    
               </tr>
              </tbody>
            </table>
          </div>
            <uib-pagination total-items="reportsVm.totalItems" ng-model="reportsVm.currentPage" items-per-page="reportsVm.itemsPerPage" max-size="reportsVm.maxSize" ng-change="reportsVm.fireCommand()" class="pagination-sm" rotate="false">  </uib-pagination>
          </div>
          <div ng-if="reportsVm.tabValue == 'toBuyOrRent'">
          <div class="table-responsive" >
            <table class="table table-bordred table-striped">
              <thead>
                <th>Sr. No</th> 
                <th>Customer</th>                                
                <th>Mobile No.</th>                                
                <th>Phone No.</th>                                
                <th>Email</th>                                
                <th>Date of Request</th>  
                <th>Country</th>  
                <th>Location</th>  
                <th>Request Type</th>
                <th>interested In</th>    
              </thead>
              <tbody>
              <tr  ng-repeat="addSvc in reportsVm.toBuyOrRentListing">
                <td>{{$index + 1+count}}</td>
                <td>{{addSvc.quote.fname}} {{addSvc.quote.lname}}</td>              
                <td>{{addSvc.quote.mobile}}</td>
                <td>{{addSvc.quote.phone}}</td>
                <td>{{addSvc.quote.email}}</td>
                <td>{{addSvc.createdAt | date:'MM/dd/yyyy'}}</td>
                <td>{{addSvc.quote.country}}</td>                    
                <td>{{addSvc.quote.city}}</td>                    
                <td>{{addSvc.quote.requesType}}</td>                    
                <td>{{addSvc.quote.interestedIn}}</td>                    
                </tr>
              </tbody>
            </table>
          </div>
            <uib-pagination total-items="reportsVm.totalItems" ng-model="reportsVm.currentPage" items-per-page="reportsVm.itemsPerPage" max-size="reportsVm.maxSize" ng-change="reportsVm.fireCommand()" class="pagination-sm" rotate="false">  </uib-pagination>
          </div>

          <div ng-if="reportsVm.tabValue == 'buyOrRentOrBoth'">
          <div class="table-responsive" >
            <table class="table table-bordred table-striped">
              <thead>
                <tr>
                  <th>Sr. No</th> 
                  <th>Full Name</th>
                  <th>Country</th> 
                  <th>Phone No.</th>                                
                  <th>Mobile No.</th>                                
                  <th>Email Address</th>                                
                  <th>Method of contact</th>  
                  <!-- <th>Request for finance</th> -->  
                  <th>Amount to be Financed</th>  
                  <th>Indicative Rate</th>  
                  <th>Tenure</th>  
                  <th>Financing Company</th> 
                  <th>Comments</th>  
                  <th>Date of Request</th>  
                  <th>Requested Products</th> 
                  <th>View Products</th> 
                </tr>
              </thead>
              <tbody>
              <tr  ng-repeat="proQuery in reportsVm.buyOrRentListing">
                <td>{{$index + 1 + count}}</td>
                <td>{{proQuery.fname}} {{proQuery.lname}}</td>     
                <td>{{proQuery.country}}</td> 
                <td>{{proQuery.phone}}</td>        
                <td>{{proQuery.mobile}}</td>
                <td>{{proQuery.email}}</td>
                <td>{{proQuery.contact}}</td>                    
                <!-- <td>{{proQuery.interestedIn}}</td> -->                  
                <td>{{proQuery.financeInfo.financeAmount}}</td>                    
                <td>{{proQuery.financeInfo.assetCost}}</td>                    
                <td>{{proQuery.financeInfo.periodInMonths}}</td>                    
                <td>{{proQuery.financeInfo.finAgency}}</td>
                <td>{{proQuery.message}}</td>     
                <td>{{proQuery.createdAt | date:'MM/dd/yyyy'}}</td>                     
                <td>{{reportsVm.getRequestedProducts(proQuery.product)}}</td>
                <td>
                  <a href="javascript:void(0);" ng-click="reportsVm.viewProductsDetail(proQuery.product)" class="btn btn-primary btn-sm">
                    <i class="fa fa-eye"></i>
                  </a>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
            <uib-pagination total-items="reportsVm.totalItems" ng-model="reportsVm.currentPage" items-per-page="reportsVm.itemsPerPage" max-size="reportsVm.maxSize" ng-change="reportsVm.fireCommand()" class="pagination-sm" rotate="false">  </uib-pagination>
          </div>
          <!-- end of to sell-->
        <div ng-if="reportsVm.tabValue == 'shipping'">
          <div class="table-responsive" >
            <table class="table table-bordred table-striped">
              <thead>
                <tr>
                  <th>Sr. No</th> 
                  <th>Full Name</th>                                
                  <th>Country</th>
                  <th>Location</th>  
                  <th>Company Name</th>
                  <th>Designation</th>  
                  <th>Phone No.</th>
                  <th>Mobile No.</th>                                
                  <th>Email Address</th>                                
                  <th>Shipment Allowed</th>  
                  <th>Packaging</th>    
                  <th>Comments</th>
                  <th>Date of Request</th> 
                </tr> 
              </thead>
              <tbody>
              <tr  ng-repeat="addSvc in reportsVm.shippingListing">
                <td>{{$index + 1+count}}</td>
                <td>{{addSvc.quote.fname}} {{addSvc.quote.lname}}</td> 
                <td>{{addSvc.quote.country}}</td>
                <td>{{addSvc.quote.city}}</td> 
                <td>{{addSvc.quote.companyname}}</td>                    
                <td>{{addSvc.quote.designation}}</td>   
                <td>{{addSvc.quote.phone}}</td>
                <td>{{addSvc.quote.mobile}}</td>
                <td>{{addSvc.quote.email}}</td>
                <td>{{addSvc.quote.allowed}}</td>                    
                <td>{{addSvc.quote.packaging}}</td>                                        
                <td>{{addSvc.quote.comment}}</td>   
                <td>{{addSvc.createdAt | date:'MM/dd/yyyy'}}</td>
               </tr>
              </tbody>
            </table>
          </div>
            <uib-pagination total-items="reportsVm.totalItems" ng-model="reportsVm.currentPage" items-per-page="reportsVm.itemsPerPage" max-size="reportsVm.maxSize" ng-change="reportsVm.fireCommand()" class="pagination-sm" rotate="false">  </uib-pagination>
          </div>
     
       <div ng-if="reportsVm.tabValue == 'valuation'">
          <div class="table-responsive" >
            <table class="table table-bordred table-striped">
              <thead>
                <tr>
                  <th>Sr. No</th> 
                  <th>Full Name</th> 
                  <th>Country</th>  
                  <th>Location</th>  
                  <th>Company Name</th>  
                  <th>Designation</th>                               
                  <th>Mobile No.</th>                                
                  <th>Phone No.</th>                                
                  <th>Email Address</th>  
                  <th>Category</th>
                  <th>Brand</th>
                  <th>Modal</th>
                  <th>Location of Asset</th>
                  <th>Manufacturing Year</th>
                  <th>Asset Description</th>
                  <th>Contact Person</th>
                  <th>Contact Number</th>                              
                  <th>Purpose of Valutaion</th>
                  <th>Schedule a Call</th>  
                  <th>Comments</th>    
                  <th>Date of Request</th> 
                </tr> 
              </thead>
              <tbody>
              <tr  ng-repeat="addSvc in reportsVm.valuationListing">
                <td>{{$index + 1+count}}</td>
                <td>{{addSvc.quote.fname}} {{addSvc.quote.lname}}</td>              
                <td>{{addSvc.quote.country}}</td>                    
                <td>{{addSvc.quote.city}}</td>                    
                <td>{{addSvc.quote.companyname}}</td>                    
                <td>{{addSvc.quote.designation}}</td>                                        
                <td>{{addSvc.quote.mobile}}</td>
                <td>{{addSvc.quote.phone}}</td>
                <td>{{addSvc.quote.email}}</td>
                <td>{{addSvc.quote.product.category}}</td>
                <td>{{addSvc.quote.product.brand}}</td>
                <td>{{addSvc.quote.product.model}}</td>
                <td>{{addSvc.quote.product.city}}</td>
                <td>{{addSvc.quote.product.mfgYear}}</td>
                <td>{{addSvc.quote.product.description}}</td>
                <td>{{addSvc.quote.product.contactPerson}}</td>
                <td>{{addSvc.quote.product.contactNumber}}</td>
                <td>
                  <span ng-if="addSvc.quote.valuation != 'Other'">{{addSvc.quote.valuation}}</span>
                  <span ng-if="addSvc.quote.valuation == 'Other'">{{addSvc.quote.otherName}}</span>
                </td>                    
                <td>{{addSvc.quote.schedule}}</td>                    
                <td>{{addSvc.quote.comment}}</td>                                       
                <td>{{addSvc.createdAt | date:'MM/dd/yyyy'}}</td>
               </tr>
              </tbody>
            </table>
          </div>
            <uib-pagination total-items="reportsVm.totalItems" ng-model="reportsVm.currentPage" items-per-page="reportsVm.itemsPerPage" max-size="reportsVm.maxSize" ng-change="reportsVm.fireCommand()" class="pagination-sm" rotate="false">  </uib-pagination>
          </div>
          
          <div ng-if="reportsVm.tabValue == 'finance'">
          <div class="table-responsive" >
            <table class="table table-bordred table-striped">
              <thead>
                  <tr>
                    <th>Sr. No</th> 
                    <th>Full Name</th> 
                    <th>Country</th>                                
                    <th>Location</th>                                
                    <th>Company Name</th>                                
                    <th>Designation</th>                                
                    <th>Phone No.</th>  
                    <th>Mobile No.</th>  
                    <th>Email Address</th>
                    <th>Category</th>
                    <th>Brand</th>
                    <th>Modal</th>
                    <th>Location of Asset</th>
                    <th>Manufacturing Year</th>
                    <th>Asset Description</th>
                    <th>Amount to be Financed</th>
                    <th>Indicative Rate</th>
                    <th>Tenure(in Months)</th>
                    <th>Method Of Contact</th>
                    <th>Comments</th>    
                    <th>Date of Request</th> 
                  </tr>
              </thead>
              <tbody>
              <tr ng-repeat="addSvc in reportsVm.financingListing">
                <td>{{$index + 1+count}}</td>             
                <td>{{addSvc.quote.fname}} {{addSvc.quote.lname}}</td>              
                <td>{{addSvc.quote.country}}</td>
                <td>{{addSvc.quote.city}}</td>
                <td>{{addSvc.quote.companyname}}</td>                    
                <td>{{addSvc.quote.designation}}</td>                                        
                <td>{{addSvc.quote.phone}}</td>
                <td>{{addSvc.quote.mobile}}</td>
                <td>{{addSvc.quote.email}}</td>
                <td>{{addSvc.quote.product.category}}</td>
                <td>{{addSvc.quote.product.brand}}</td>
                <td>{{addSvc.quote.product.model}}</td>
                <td>{{addSvc.quote.product.city}}</td>
                <td>{{addSvc.quote.product.mfgYear}}</td>
                <td>{{addSvc.quote.product.description}}</td>
                <td>{{addSvc.quote.amountToBeFinanced}}</td>
                <td>{{addSvc.quote.indicativeRate}}</td>
                <td>{{addSvc.quote.periodInMonths}}</td>
                <td>{{addSvc.quote.contactMethod}}</td>               
                <td>{{addSvc.quote.comment}}</td>
                <td>{{addSvc.createdAt | date:'MM/dd/yyyy'}}</td>
               </tr>
              </tbody>
            </table>
          </div>
            <uib-pagination total-items="reportsVm.totalItems" ng-model="reportsVm.currentPage" items-per-page="reportsVm.itemsPerPage" max-size="reportsVm.maxSize" ng-change="reportsVm.fireCommand()" class="pagination-sm" rotate="false">  </uib-pagination>
          </div>

          <div ng-if="reportsVm.tabValue == 'insurance'">
          <div class="table-responsive" >
            <table class="table table-bordred table-striped">
              <thead>
               <tr>
                <th>Sr. No</th> 
                <th>Full Name</th> 
                <th>Country</th>                                
                <th>Location</th>                                
                <th>Company Name</th>                                
                <th>Designation</th>                                
                <th>Phone No.</th>  
                <th>Mobile No.</th>  
                <th>Email Address</th>
                <th>Category</th>
                <th>Brand</th>
                <th>Modal</th>
                <th>Location of Asset</th>
                <th>Manufacturing Year</th>
                <th>Asset Description</th>
                <th>Invoice value</th>
                <th>Method Of Contact</th>
                <th>Comments</th>
                <th>Date of Request</th>
               </tr> 
              </thead>
              <tbody>
              <tr ng-repeat="addSvc in reportsVm.insuranceListing">
                <td>{{$index + 1+count}}</td>            
               <td>{{addSvc.quote.fname}} {{addSvc.quote.lname}}</td>              
                <td>{{addSvc.quote.country}}</td>
                <td>{{addSvc.quote.city}}</td>
                <td>{{addSvc.quote.companyname}}</td>                    
                <td>{{addSvc.quote.designation}}</td>                                        
                <td>{{addSvc.quote.phone}}</td>
                <td>{{addSvc.quote.mobile}}</td>
                <td>{{addSvc.quote.email}}</td>
                <td>{{addSvc.quote.product.category}}</td>
                <td>{{addSvc.quote.product.brand}}</td>
                <td>{{addSvc.quote.product.model}}</td>
                <td>{{addSvc.quote.product.city}}</td>
                <td>{{addSvc.quote.product.mfgYear}}</td>
                <td>{{addSvc.quote.product.description}}</td>
                <td>{{addSvc.quote.invoiceVal}}</td>
                <td>{{addSvc.quote.contactMethod}}</td>               
                <td>{{addSvc.quote.comment}}</td>    
                <td>{{addSvc.createdAt | date:'MM/dd/yyyy'}}</td>
               </tr>
              </tbody>
            </table>
          </div>
            <uib-pagination total-items="reportsVm.totalItems" ng-model="reportsVm.currentPage" items-per-page="reportsVm.itemsPerPage" max-size="reportsVm.maxSize" ng-change="reportsVm.fireCommand()" class="pagination-sm" rotate="false">  </uib-pagination>
          </div>


    </div>
  </div>
</div>
<script type="text/ng-template" id="viewProductList.html">
  <div>
    <div class="modal-header">
      <button type="button" class="close" ng-click="close()" aria-hidden="true">&times;</button>
      <h4 class="modal-title">View Detail</h4>
    </div>
      <div class="modal-body">
        <div class="table-responsive">
            <table class="table table-bordred table-striped">
              <thead>
                <tr>
                  <th>Product ID</th>
                  <th>Asset ID</th>  
                  <th>Category</th>  
                  <th>Brand</th>  
                  <th>Model</th>  
                  <th>Manufacturing Year</th>
                  <th>Asset Location</th>
                  <th>Trading Type</th>
                  <th>Price</th>
                </tr>      
              </thead>
              <tbody>
                <tr ng-repeat="product in productList">
                  <td>{{product.productId}}</td>
                  <td>{{product.assetId}}</td>
                  <td>{{product.category}}</td>
                  <td>{{product.brand}}</td>
                  <td>{{product.model}}</td>
                  <td>{{product.mfgYear}}</td>
                  <td>{{product.city}}</td>
                  <td>{{product.tradeType}}</td>
                  <td>{{product.grossPrice}}</td>
                </tr>
              </tbody>
            </table>
        </div>
     
      </div>
  </div>
</script>